{% extends 'base.html' %}

{% block app_content %}
<div class="container">
    <table class="table">
        <tr>
            <td width="256px"><img src="{{ user.avatar(256) }}"></td>
            <td>
                <h1>User: {{ user.username }}</h1>
                {% if user.about_me %}<p>Description: {{ user.about_me }}</p>{% endif %}
                {% if user.last_seen %}<p>Last seen on: {{ user.last_seen }}</p>{% endif %}
                {% if user == current_user %}
                <form action="{{ url_for('main.edit_profile') }}" method="GET">
                    <button type="submit" class="btn btn-primary mr-3">Edit your profile</button>
                </form>
                <form action="{{ url_for('main.delete_account', user_id=current_user.id) }}" method="POST">
                    <button type="submit" class="btn btn-danger mr-3 my-2">Delete account</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% if current_user.id == user.id %}
        <tr>
            <td colspan="2">
                <div class="container md-6">
                    <h2>Your groups:</h2>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">Group Name</th>
                                <th scope="col">Group Avatar</th>
                                <th scope="col">Group Description</th>
                                <th scope="col">Group Owner Name</th>
                                <th scope="col">Creation Date</th>
                                <th scope="col">Members</th>
                            </tr>
                        </thead>
                        {% for group in current_user.groups %}
                        {% include '_group.html' %}
                        {% endfor %}
                    </table>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="container mt-4">
                    <h2>Here are your invitations:</h2>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">Group Name</th>
                                <th scope="col">Group Avatar</th>
                                <th scope="col">Group Description</th>
                                <th scope="col">Group Owner Name</th>
                                <th scope="col">Invitation Date</th>
                                <th scope="col">Status</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        {% for invitation in current_user.invitations %}
                        {% include '_invitation.html' %}
                        {% endfor %}
                    </table>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="container mt-4">
                    <h2>Here are your requests:</h2>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">Group Name</th>
                                <th scope="col">Group Avatar</th>
                                <th scope="col">Group Description</th>
                                <th scope="col">Group Owner Name</th>
                                <th scope="col">Request Sent Date</th>
                                <th scope="col">Status</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        {% for membership_request in current_user.membership_requests %}
                        {% include '_membership_request.html' %}
                        {% endfor %}
                    </table>
                </div>
            </td>
        </tr>
        {% else %}

        {% endif %}
    </table>


</div>
{% endblock %}